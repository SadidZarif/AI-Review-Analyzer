=================================================================
AI REVIEW ANALYZER - BACKEND FEATURES TODO
=================================================================

This file documents features that are visible in the UI but not yet 
implemented in the backend. Implement these progressively.

=================================================================
HIGH PRIORITY
=================================================================

1. STAR RATINGS (1-5 SCALE)
   -------------------------
   Status: TODO
   Current: Binary sentiment (positive/negative only)
   Needed: Numeric rating scale 1-5
   
   Changes Required:
   - Update ReviewResult schema to include 'rating: int' field
   - Modify ML model to predict ratings instead of just sentiment
   - Could map confidence scores to ratings initially:
     * confidence > 0.9 → 5 stars
     * confidence > 0.7 → 4 stars
     * confidence > 0.5 → 3 stars
     * confidence > 0.3 → 2 stars
     * else → 1 star
   
   Files to modify:
   - backend/schemas.py (ReviewResult)
   - backend/models.py (SentimentAnalyzer)


2. NEUTRAL SENTIMENT CATEGORY
   ---------------------------
   Status: TODO
   Current: Only positive/negative classification
   Needed: Add "neutral" as third sentiment category
   
   Changes Required:
   - Update ML model from binary to 3-class classification
   - Retrain with neutral examples
   - Update schemas to accept "neutral" as valid sentiment
   - Adjust topic extraction to handle neutral reviews
   
   Files to modify:
   - backend/models.py (SentimentAnalyzer._train_model)
   - backend/schemas.py (sentiment type hints)
   - backend/models.py (TopicExtractor)


3. AI REPLY SUGGESTIONS
   ---------------------
   Status: TODO
   New Feature: Generate contextual reply suggestions for reviews
   
   Implementation Options:
   a) Template-based (Quick implementation):
      - Positive templates: "Thank you for...", "We're glad..."
      - Negative templates: "We apologize...", "We'll address..."
      - Match based on keywords/topics
   
   b) LLM Integration (Advanced):
      - OpenAI API / Anthropic API
      - Generate custom responses
      - More natural and contextual
   
   Endpoint Design:
   POST /generate-reply
   Request: {
     "review_text": "string",
     "sentiment": "positive|negative|neutral",
     "topics": ["keyword1", "keyword2"]
   }
   Response: {
     "suggested_reply": "string",
     "template_used": "string|null"
   }
   
   Files to create:
   - backend/reply_generator.py (new module)
   - backend/main.py (add endpoint)


4. REVIEW METADATA
   ----------------
   Status: TODO
   Current: Only text, sentiment, confidence
   Needed: Additional metadata fields
   
   Fields to add:
   - reviewer_name: str (from Shopify if available)
   - reviewer_avatar: str (URL or generate from initials)
   - timestamp: datetime (when review was posted)
   - product_name: str (linked product)
   - product_id: str (Shopify product ID)
   - review_source: str ("manual", "shopify", "judge_me", etc.)
   
   Changes Required:
   - Update ReviewResult schema with optional fields
   - Modify Shopify integration to extract metadata
   - Store review source information
   
   Files to modify:
   - backend/schemas.py (ReviewResult)
   - backend/integrations/shopify.py (extract metadata)


=================================================================
MEDIUM PRIORITY
=================================================================

5. TRUST INDEX CALCULATION
   ------------------------
   Status: TODO
   New Feature: Calculate trust/credibility score for reviews
   
   Factors to consider:
   - Verified purchase badge (if available from Shopify)
   - Reviewer history (number of previous reviews)
   - Review length (detailed vs short)
   - Sentiment consistency (not extreme flip-flopping)
   - Time since purchase (recent reviews more reliable)
   
   Implementation:
   - Create scoring algorithm (weighted factors)
   - Return value: "High", "Medium", "Low" or numeric 0-100
   - Include in review metadata
   
   Files to create/modify:
   - backend/trust_calculator.py (new module)
   - backend/schemas.py (add trust_index field)
   - backend/main.py (integrate in analysis)


6. URGENCY LEVEL DETECTION
   ------------------------
   Status: TODO
   New Feature: Identify reviews requiring immediate attention
   
   Urgency Criteria:
   - Low: Positive reviews, no complaints
   - Medium: Mixed sentiment, minor issues mentioned
   - High: Negative reviews, product defects, safety concerns
   - Critical: Legal threats, requests for refund, viral potential
   
   Implementation:
   - Keyword-based urgency detection
   - Negative sentiment + specific keywords → high urgency
   - Recent + negative + high engagement → critical
   
   Files to create:
   - backend/urgency_detector.py (new module)
   - backend/schemas.py (add urgency_level field)


7. REVIEW PHRASE HIGHLIGHTING
   ---------------------------
   Status: TODO
   New Feature: Extract and highlight sentiment-bearing phrases
   
   Current: Whole review classified as positive/negative
   Needed: Identify specific phrases and their sentiments
   
   Example:
   "The build quality is fantastic, but shipping was slow."
   → ["The build quality is fantastic" (positive),
       "shipping was slow" (negative)]
   
   Implementation:
   - Sentence-level sentiment analysis
   - Aspect-based sentiment (product, shipping, service)
   - Return phrase + sentiment + context
   
   Files to create:
   - backend/phrase_extractor.py (new module)
   - backend/schemas.py (add highlighted_phrases field)


8. CUSTOMER PROFILE INTEGRATION
   ------------------------------
   Status: TODO
   New Feature: Link reviews to customer profiles
   
   Data to collect (from Shopify):
   - customer_id, name, email
   - avatar (or generate from initials)
   - location (city, country)
   - total_spend (lifetime value)
   - review_count (total reviews written)
   - loyalty_tier (based on spend: Bronze, Silver, Gold, Platinum)
   
   Implementation:
   - Fetch customer data via Shopify Customer API
   - Calculate loyalty tier programmatically
   - Cache customer data to reduce API calls
   
   Files to modify:
   - backend/integrations/shopify.py (add customer methods)
   - backend/schemas.py (add CustomerProfile schema)


9. RATING DISTRIBUTION STATS
   --------------------------
   Status: TODO
   New Feature: Aggregate star rating breakdown
   
   Current: Individual reviews
   Needed: Distribution across 1-5 stars
   
   Example Output:
   {
     "5_star": {"count": 60, "percentage": 60},
     "4_star": {"count": 30, "percentage": 30},
     "3_star": {"count": 10, "percentage": 10},
     "2_star": {"count": 0, "percentage": 0},
     "1_star": {"count": 0, "percentage": 0},
     "average_rating": 4.5
   }
   
   Files to modify:
   - backend/models.py (add rating aggregation method)
   - backend/schemas.py (add RatingDistribution schema)


10. HISTORICAL TREND DATA
   ---------------------
   Status: TODO
   New Feature: Time-series sentiment data for charts
   
   Endpoint Design:
   GET /analytics/trends?period=week|month|year
   Response: {
     "period": "week",
     "data_points": [
       {
         "date": "2024-01-15",
         "sentiment_score": 85,
         "positive_count": 120,
         "negative_count": 20,
         "total_reviews": 140
       },
       ...
     ]
   }
   
   Implementation:
   - Requires database to store analysis history
   - Aggregate reviews by date
   - Calculate daily/weekly metrics
   
   Files to create:
   - backend/database.py (SQLite/PostgreSQL setup)
   - backend/analytics.py (trend calculations)
   - backend/main.py (add endpoint)


11. DATE RANGE FILTERING
    --------------------
    Status: TODO
    Current: Analyzes all provided reviews
    Needed: Filter by date range
    
    Changes:
    - Add date parameters to /analyze-reviews
    - Support date_from, date_to query params
    - Support preset ranges: "last_week", "last_month", "last_year"
    
    Files to modify:
    - backend/schemas.py (add DateRangeRequest)
    - backend/main.py (update analyze endpoints)


12. PENDING ACTIONS DETECTION
    --------------------------
    Status: TODO
    New Feature: Identify reviews needing response
    
    Logic:
    - Negative reviews without replies → urgent
    - Reviews older than X days → follow-up needed
    - Low ratings (1-2 stars) → high priority
    
    Endpoint:
    GET /pending-actions
    Response: {
      "urgent_count": 5,
      "follow_up_count": 12,
      "reviews": [...]
    }
    
    Files to create:
    - backend/action_detector.py


13. WEEKLY/PERIOD COMPARISON
    -------------------------
    Status: TODO
    Current: Shows absolute numbers
    Needed: Show change vs previous period
    
    Example: "88/100 (+5.2% vs last week)"
    
    Requires:
    - Historical data storage (see #10)
    - Calculate deltas between periods
    - Return comparison metrics
    
    Files to modify:
    - backend/analytics.py (add comparison logic)
    - backend/schemas.py (add delta fields)


=================================================================
LOW PRIORITY
=================================================================

14. EXPORT REPORT FEATURE
    ---------------------
    Status: TODO
    New Feature: Generate downloadable reports
    
    Formats:
    - PDF: Charts, statistics, sample reviews
    - CSV: Raw data export
    - Excel: Formatted spreadsheet
    
    Endpoint:
    GET /export/report?format=pdf|csv|excel
    
    Libraries:
    - ReportLab (PDF generation)
    - pandas.to_csv() (CSV)
    - openpyxl (Excel)
    
    Files to create:
    - backend/report_generator.py


15. KEYWORD FREQUENCY ANALYSIS
    --------------------------
    Status: TODO
    Current: Returns top keywords only
    Needed: Include frequency counts for sizing
    
    Example:
    Instead of: ["battery", "screen", "delivery"]
    Return: [
      {"keyword": "battery", "count": 45, "frequency": 0.32},
      {"keyword": "screen", "count": 38, "frequency": 0.27},
      ...
    ]
    
    Used for: Variable-sized keyword cloud in UI
    
    Files to modify:
    - backend/models.py (TopicExtractor.extract_topics)
    - backend/schemas.py (TopicInfo schema)


=================================================================
INFRASTRUCTURE / DATABASE
=================================================================

For features #8, #9, #10, #11, #12, #13, a database is needed:

Recommended: PostgreSQL (production) or SQLite (development)

Tables needed:
- analyses (id, timestamp, store_name, total_reviews, ...)
- reviews (id, analysis_id, text, sentiment, rating, ...)
- customers (id, name, email, location, total_spend, loyalty_tier)
- reply_templates (id, sentiment, keywords, template_text)

Files to create:
- backend/database.py (connection, models)
- backend/migrations/ (schema migrations)

ORM Options:
- SQLAlchemy (most popular)
- Tortoise ORM (async-native)


=================================================================
IMPLEMENTATION NOTES
=================================================================

PHASE 1 - REVIEW DETAILS PAGE (High Priority):
1. #1 (Star Ratings) - Easy win, high impact
2. #5 (Trust Index) - Review credibility scoring
3. #6 (Urgency Detection) - Prioritize responses
4. #7 (Phrase Highlighting) - Better UX in UI
5. #8 (Customer Profiles) - Shopify integration
6. #9 (Rating Distribution) - Analytics enhancement

PHASE 2 - CORE ML IMPROVEMENTS:
7. #2 (Neutral Sentiment) - 3-class classification
8. #3 (AI Reply Suggestions) - Auto-generate responses
9. #4 (Review Metadata) - Enrich data

PHASE 3 - ANALYTICS & DATABASE:
10. Database setup (PostgreSQL/SQLite)
11. #10 (Historical Trends) - Time-series analytics
12. #11 (Date Range Filtering) - Query flexibility
13. #12 (Pending Actions) - Action items dashboard
14. #13 (Period Comparison) - Week-over-week tracking

PHASE 4 - NICE TO HAVE:
15. #14 (Export Reports) - PDF/CSV/Excel downloads
16. #15 (Keyword Frequency) - Enhanced keyword cloud

Priority: High (#1, 5-9) → Medium (#2-4, 10-13) → Low (#14-15)
Complexity: 
  High (#2, #7, #10) 
  Medium (#1, #3, #5, #6, #8, #11-13)
  Low (#4, #9, #14, #15)

=================================================================
INVENTORY/PRODUCTS PAGE FEATURES
=================================================================

16. PRODUCT MANAGEMENT API
    -----------------------
    Status: TODO
    New Feature: Products CRUD operations and analytics
    
    Endpoints Needed:
    - GET /products - List all products with filters
    - GET /products/:id - Single product details
    - POST /products - Add new product (ASIN/Shopify link)
    - PUT /products/:id - Update product info
    - DELETE /products/:id - Remove product
    - GET /products/:id/reviews - Product reviews list
    - GET /products/:id/insights - AI insights for product
    
    Data Model (Product):
    {
      id: string,
      name: string,
      asin: string,
      category: string,
      image_url: string,
      is_linked: boolean,
      source: "amazon" | "shopify" | "manual",
      created_at: datetime,
      updated_at: datetime
    }
    
    Files to create:
    - backend/schemas.py (ProductSchema, ProductCreate, ProductUpdate)
    - backend/database.py (Products table)
    - backend/main.py (CRUD endpoints)


17. PER-PRODUCT SENTIMENT AGGREGATION
    ----------------------------------
    Status: TODO
    New Feature: Calculate sentiment metrics per product
    
    Data needed:
    - Average rating (1-5 stars)
    - Sentiment breakdown (positive %, neutral %, negative %)
    - Total reviews count
    - Rating status ("excellent", "good", "critical", "unlinked")
    - Top keywords/tags per product
    
    Endpoint:
    GET /products/:id/analytics
    Response: {
      rating: 4.8,
      rating_status: "excellent",
      total_reviews: 1234,
      sentiment: {
        positive: 75,
        neutral: 15,
        negative: 10
      },
      top_tags: [
        { text: "Audio Quality", type: "positive" },
        { text: "Battery", type: "positive" },
        { text: "Price", type: "negative" }
      ],
      reviews_growth: 12
    }
    
    Files to modify:
    - backend/models.py (add product-level aggregation)
    - backend/schemas.py (ProductAnalytics schema)


18. AMAZON/SHOPIFY PRODUCT IMPORT
    -----------------------------
    Status: TODO
    New Feature: Import products from external sources
    
    Amazon Integration:
    - Parse ASIN from URL
    - Fetch product details via Amazon Product API
    - Scrape reviews and analyze
    
    Shopify Integration:
    - Use existing Shopify client
    - Fetch products with their reviews
    - Link to review apps (Judge.me etc)
    
    Endpoint:
    POST /products/import
    Request: {
      source: "amazon" | "shopify",
      identifier: "B08X45Y7" | "https://shop.example.com/products/xyz"
    }
    
    Files to create:
    - backend/integrations/amazon.py (Amazon Product API)
    - backend/main.py (import endpoint)


19. CRITICAL ISSUES DETECTION
    -------------------------
    Status: TODO
    New Feature: Flag products with high negative sentiment
    
    Criteria:
    - Rating < 3.5 stars
    - Negative sentiment > 40%
    - Specific keywords (defect, broken, refund, terrible)
    - Recent spike in negative reviews
    
    Endpoint:
    GET /products/critical
    Response: {
      count: 3,
      products: [{ id, name, issues: [...] }]
    }
    
    Files to create:
    - backend/critical_detector.py
    - backend/main.py (critical endpoint)


20. GLOBAL INVENTORY STATS
    ----------------------
    Status: TODO
    New Feature: Aggregate stats across all products
    
    Stats needed:
    - Total reviews analyzed
    - Reviews growth % (vs last period)
    - Global sentiment score (average)
    - Critical issues count
    - Products count by status
    
    Endpoint:
    GET /inventory/stats
    Response: {
      reviews_analyzed: 54200,
      reviews_growth: 12,
      global_sentiment: 4.2,
      critical_issues: 3,
      products_by_status: {
        excellent: 10,
        good: 25,
        critical: 3,
        unlinked: 5
      }
    }
    
    Files to create:
    - backend/analytics.py (aggregate calculations)
    - backend/schemas.py (InventoryStats schema)

=================================================================
SETTINGS PAGE FEATURES
=================================================================

21. USER PROFILE & API KEY MANAGEMENT
    ----------------------------------
    Status: TODO
    New Feature: User account management
    
    Endpoints Needed:
    - GET /user/profile - Get user profile data
    - PUT /user/profile - Update profile (name, email, avatar)
    - POST /user/api-key/regenerate - Generate new API key
    - GET /user/subscription - Get plan details
    
    Data Model (User):
    {
      id: string,
      name: string,
      email: string,
      avatar_url: string,
      plan: "free" | "pro" | "enterprise",
      member_since: datetime,
      api_key: string (hashed)
    }
    
    Security:
    - API key hashing with bcrypt
    - Rate limiting per user
    - JWT authentication
    
    Files to create:
    - backend/auth.py (authentication logic)
    - backend/schemas.py (UserProfile schema)
    - backend/main.py (user endpoints)


22. PLATFORM INTEGRATIONS MANAGEMENT
    ---------------------------------
    Status: TODO
    New Feature: Connect/disconnect external platforms
    
    Platforms Supported:
    - Amazon (Product API + Reviews)
    - Shopify (Admin API + Review Apps)
    - Etsy (coming soon)
    
    Endpoints:
    - GET /integrations - List all integrations
    - POST /integrations/:platform/connect - OAuth flow start
    - GET /integrations/:platform/callback - OAuth callback
    - DELETE /integrations/:platform/disconnect - Disconnect
    - POST /integrations/:platform/sync - Manual sync trigger
    
    Data Model (Integration):
    {
      platform: "amazon" | "shopify" | "etsy",
      status: "connected" | "inactive" | "error",
      access_token: string (encrypted),
      refresh_token: string (encrypted),
      last_synced: datetime,
      store_name: string,
      store_url: string
    }
    
    Files to create:
    - backend/integrations/oauth.py (OAuth flows)
    - backend/schemas.py (Integration schema)


23. NOTIFICATION SETTINGS
    ----------------------
    Status: TODO
    New Feature: User notification preferences
    
    Settings:
    - critical_alerts: bool (1-star review alerts)
    - weekly_digest: bool (email summary)
    - auto_reply_confirmation: bool (confirm before posting)
    - email_notifications: bool
    - push_notifications: bool
    
    Endpoints:
    - GET /user/notifications - Get settings
    - PUT /user/notifications - Update settings
    
    Implementation:
    - Store in user preferences table
    - Email service integration (SendGrid/SES)
    - Background job for digests (Celery)
    
    Files to create:
    - backend/notifications.py (notification logic)
    - backend/email_service.py (email sending)


24. AI MODEL CONFIGURATION
    -----------------------
    Status: TODO
    New Feature: Customize AI behavior per user
    
    Settings:
    - sensitivity: int (1-100, how strict sentiment detection)
    - reply_tone: "professional" | "friendly" | "empathetic"
    - blocked_keywords: list[str] (words to filter)
    - auto_reply_enabled: bool
    - language_preference: str
    
    Endpoints:
    - GET /user/ai-config - Get AI settings
    - PUT /user/ai-config - Update settings
    
    Implementation:
    - Apply sensitivity to confidence thresholds
    - Use tone for reply generation prompts
    - Filter blocked keywords from responses
    
    Files to modify:
    - backend/models.py (apply user settings)
    - backend/schemas.py (AIConfig schema)


25. USAGE TRACKING & BILLING
    -------------------------
    Status: TODO
    New Feature: Track API usage and billing
    
    Track:
    - reviews_analyzed_this_month: int
    - api_calls_this_month: int
    - credits_used: int
    - credits_limit: int (based on plan)
    
    Plans:
    - Free: 1000 reviews/month
    - Pro: 50000 reviews/month
    - Enterprise: Unlimited
    
    Endpoints:
    - GET /user/usage - Get usage stats
    - GET /user/billing - Get billing info
    - POST /user/upgrade - Upgrade plan (Stripe integration)
    
    Files to create:
    - backend/billing.py (Stripe integration)
    - backend/usage_tracker.py (usage counting)

=================================================================

